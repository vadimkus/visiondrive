# 11.3.3 Map interactions — selection + highlight + auto-scroll + filters

This doc adds the first “enterprise-feel” UX upgrade on top of the Mapbox portal map:

- Click-to-select a bay
- Selected bay highlight on the map
- Auto-scroll + highlight in the details list
- Filters (Offline / Unknown / Occupied)

## What changed

### Map page state + filters + details list sync

File: `app/portal/map/page.tsx`

- Added:
  - `selectedBayId` state
  - `filters` state: `OCCUPIED / OFFLINE / UNKNOWN`
  - `filteredItems` derived list
- Filters UI:
  - checkboxes for Offline / Unknown / Occupied
  - “Clear” button
  - “Showing X / Y” indicator
- Details list:
  - shows `filteredItems`
  - click a row selects the bay (updates `selectedBayId`)
  - selected row gets a subtle highlight
- Auto-scroll:
  - when `selectedBayId` changes, the list scrolls to the matching row via `scrollIntoView()`

### Mapbox selection hook + highlight layers

File: `app/portal/map/MapboxMap.tsx`

- Added props:
  - `selectedBayId`
  - `onSelectBay(bayId)`
- Click on a bay polygon/point now:
  - calls `onSelectBay(bayId)` (kept via a ref so map handlers don’t need re-registering)
  - still opens the popup
- Highlight layers:
  - `bays-selected-outline` (polygon)
  - `bays-selected-pt` (point fallback)
  - highlight filter updates when `selectedBayId` changes

## How to verify

1) Open:

- `/portal/map?zoneId=<zone>`

2) Click a bay:

- It highlights on the map
- The details list scrolls to that bay and highlights the row

3) Toggle filters:

- Turn on “Offline” or “Occupied” and confirm the map + list reduce to those bays.


